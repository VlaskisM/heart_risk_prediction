### **Heart Risk Prediction — ML-сервис для оценки риска сердечных заболеваний**



Этот проект представляет собой систему машинного обучения для предсказания риска сердечных заболеваний по данным пациента.



Проект включает:



###### **Основной функционал**



1. Исследование и анализ датасета (EDA).



2\. Предобработку данных: очистку, устранение утечек, преобразование к нужному типу.



3. Обучение ML-модели (Scikit-learn, XGBoost) и выбор оптимальной метрики качества.



4\. Генерацию предсказаний для тестовой выборки (id, prediction).



5\. Разработку FastAPI-сервиса, который принимает CSV-файл и возвращает предсказания в формате JSON.





###### **Стек технологий**



Python, Pandas, NumPy, Scikit-learn, XGBoost, FastAPI.



###### **Структура результата**



В репозитории представлены:



1. Jupyter Notebook с исследованием и обучением моделей



2\. Код приложения и модулей (ООП архитектура)



3\. FastAPI-сервис для получения предсказаний



4\. Файл предсказаний на тестовой выборке



5\. README с документацией





### **Документация модулей и файлов**





#### app.py — FastAPI-приложение



###### **Описание**



Файл содержит веб-сервис, принимающий CSV-файл, выполняющий предсказание модели, и возвращающий результат в формате JSON.

Используется в качестве API-слоя между пользователем и моделью.



###### **Эндпоинты**

GET /health



Проверка работоспособности сервиса.



Ответ:



{"status": "OK!"}



POST /predict



Принимает CSV-файл, выполняет предсказание модели.



###### **Параметры:**



* file: UploadFile — CSV с данными пациентов.



###### **Возвращает:**

Список объектов вида:



\[

  {"id": 1, "prediction": 0},

  {"id": 2, "prediction": 1}

]





###### **Последовательность обработки внутри эндпоинта:**



1. Чтение CSV в DataFrame.



2\. Логирование размера данных.



3\. Вызов метода model.pred\_target() для обработки и инференса.



4\. Формирование итогового DataFrame с предсказаниями.



5\. Возврат JSON-ответа.







#### logging\_file.py — логирование



###### **Функция** setup\_logging()



Настраивает глобальный лог-формат и вывод логов в консоль.



###### **Формат логов:**



2025-11-16 20:25:11 | preprocessor | INFO | Сообщение



###### **Использование:**

Автоматически вызывается при старте приложения.





#### model.py — класс Model



Класс Model отвечает за то, чтобы:



* загрузить обученную модель из файла,



* подготовить входные данные,



* получить по ним предсказания.



FastAPI просто вызывает этот класс, когда нужно сделать прогноз.



#### class Model



###### **Инициализация**



Model(model\_pipeline\_path: str)





###### **Параметры:**



* model\_pipeline\_path — путь к сериализованному пайплайну (например, model\_pipeline.pkl).



###### **Атрибуты**



* self.model — ML-модель/пайплайн, загруженная joblib.



* self.preprocessor — экземпляр класса Preprocessor.



###### **Методы**



pred\_target(self, data: pd.DataFrame) -> np.ndarray



Выполняет полный цикл:



1. Предобработка входных данных через Preprocessor.transform()



2\. Логирование размера и списка колонок



3\. Предсказание модели (self.model.predict)



4\. Возврат предсказанных данных

###### 

###### **Параметры:**



* data: DataFrame с исходными данными



###### **Возвращает:**



* y\_pred: массив предсказаний (формат зависит от вашей модели)





#### preprocessor.py — класс Preprocessor



###### **Описание**



Класс Preprocessor преобразует входной DataFrame к тому виду, который ожидает модель.

Здесь реализована ручная предобработка данных.







#### class Preprocessor



###### **Методы**



transform(self, data: pd.DataFrame) -> pd.DataFrame



###### **Основной метод предобработки данных.**



Шаги обработки



1. fillna(0) — заполнение пропусков нулями



2\. Преобразование пола в бинарные значения (Male → 1.0, Female → 0.0)



3\. Преобразование ряда медицинских признаков в строковый тип



4\. Удаление признаков с утечкой (CK-MB, Troponin)



5\. Удаление ненужных столбцов (Unnamed: 0, id)



6\. Логирование завершения трансформации



###### **Параметры:**



* data — сырые данные пользователя (DataFrame)

###### 

###### **Возвращает:**



* очищенный и преобразованный DataFrame, готовый для подачи в модель
